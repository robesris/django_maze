<html>
  <head>
   <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="./underscore.js" type="text/javascript"> </script>
    <script src="./backbone.js" type="text/javascript"> </script>


    
   

    <script>
      Maze = Backbone.Model.extend({
        urlRoot: 'http://maze.froganddragon.com/r_mazes',
        initialize: function(){
          console.log("Created a new maze.");
          this.on('change:name', function(maze) {
            console.log('Changed name to ' + maze.get('name'));
          });
        },
        defaults: {
          name: 'New Maze'
        }
      });

      Room = Backbone.Model.extend({
        initialize: function(){
          console.log("Created a new room.");
          this.on('change:name', function(room) {
            alert('Changed name to ' + room.get('name'));
          });
        },
        defaults: {
          name: 'Generic New Room',
          description: 'New Room!',
          north: null,
          south: null,
          east: null,
          west: null
        }
      });
    
      var mazes = new Backbone.Collection;
      //mazes.url = 'http://testserver.loc:8888/r_mazes'
      mazes.url = 'http://maze.froganddragon.com/r_mazes';
      mazes.fetch({

        success: function(mazes) {
          console.log("Collection Success.");
          console.log(mazes);
        },
        error: function(mazes) {
          console.log("Collection Error.");
          console.log(mazes);
        }
    });
       
var maze = new Maze({id: 1});
      maze.fetch({
        success: function(maze) {
          console.log("SUCCESS!");
          console.log(maze.toJSON());
        },
        error: function(maze) {
          console.log("ERROR!");
          console.log(maze.toJSON());
        }
      });
    
var myView = function(MazeItemView) {
    var MazeView = Backbone.View.extend({
        el: $('#maze_div'),
        events: {
        },
        initialize: function(){
            this.collection.on('add', this.render, this);
        },

        render: function(){
            var $el = $(this.el), self=this;

            this.collection.each(function(list) {
                var maze;
                maze = new MazeItemView({ model: list });

                $el.append(item.render().el);
            });

            return this;
        }
    });

    return MazeView;
};

var subView = Backbone.View.extend({
    initialize: function() {
        this.render();
    },

    render: function() {
        console.log(this.$el);
        this.$el.html(_.template($('#maze_template').html(), {maze_name:
            this.model.attributes['name']}));
        
    }
});
    
$(window).load(function() {
    var maze_view = new subView({model: maze,  el: $('#maze_container')});
});
      /************
      Added to httpd.conf:

      NameVirtualHost *

<VirtualHost 0.0.0.0:80>
    DocumentRoot "/Applications/MAMP/htdocs"
</VirtualHost>


<VirtualHost *:80>
    ServerName "testserver.loc"
    DocumentRoot "~/code/backbone"

    <Directory "~/code/backbone">
        Options All
        AllowOverride All
        Order allow,deny
        Allow from all
    </Directory>

    ProxyPass /r_mazes http://localhost:8000/r_mazes
    ProxyPassReverse /r_mazes http://localhost:8000/r_mazes
</VirtualHost>
*************/

    </script>
   </head>

   <body>
       <div id="maze_container"></div>
       <script type='text/template' id='maze_template'>
                             <%= maze_name %>
            </script>


           </body>
</html>

